From 90fe3e5042cfd667d057ee32b7ca1906302c85cd Mon Sep 17 00:00:00 2001
From: Akash Yadav <itsaky01@gmail.com>
Date: Sun, 18 May 2025 01:18:25 +0530
Subject: [PATCH] fix: allow overriding build date using system env

Signed-off-by: Akash Yadav <itsaky01@gmail.com>
---
 .../plugins/config/src/main/java/ConfigPlugin.kt           | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/mobile/android/android-components/plugins/config/src/main/java/ConfigPlugin.kt b/mobile/android/android-components/plugins/config/src/main/java/ConfigPlugin.kt
index 4e86c3c8e3..aab8a4c801 100644
--- a/mobile/android/android-components/plugins/config/src/main/java/ConfigPlugin.kt
+++ b/mobile/android/android-components/plugins/config/src/main/java/ConfigPlugin.kt
@@ -71,7 +71,12 @@ object Config {
     private val fennecBaseVersionCode by lazy {
         val format = SimpleDateFormat("yyyyMMddHHmmss", Locale.US)
         val cutoff = format.parse("20141228000000")
-        val build = Date()
+        var build = Date()
+
+        val buildDate = System.getenv("IF_BUILD_DATE")
+        if (!buildDate.isNullOrBlank()) {
+            build = Date.from(java.time.Instant.parse(buildDate))
+        }
 
         Math.floor((build.time - cutoff.time) / (1000.0 * 60.0 * 60.0)).toInt()
     }
-- 
2.49.0

