From ca75f2556d3c43a290ce5c0030670f7b30467fae Mon Sep 17 00:00:00 2001
From: celenity <celenity@celenity.dev>
Date: Tue, 17 Feb 2026 03:44:28 +0000
Subject: [PATCH] fix: Disable crash reporting

Signed-off-by: celenity <celenity@celenity.dev>
---
 .../fenix/app/src/main/AndroidManifest.xml       |  4 ++--
 .../java/org/mozilla/fenix/FenixApplication.kt   | 16 ++++++++--------
 .../fenix/components/BackgroundServices.kt       |  2 +-
 .../fenix/debugsettings/crashtools/CrashTools.kt |  8 ++++----
 .../debugsettings/navigation/DebugDrawerRoute.kt |  8 ++++----
 .../store/DebugDrawerNavigationMiddleware.kt     |  2 +-
 .../search/BrowserToolbarSearchMiddleware.kt     |  4 ++--
 .../fenix/search/SearchDialogController.kt       |  4 ++--
 .../java/org/mozilla/fenix/utils/Settings.kt     |  4 ++--
 9 files changed, 26 insertions(+), 26 deletions(-)

diff --git a/mobile/android/fenix/app/src/main/AndroidManifest.xml b/mobile/android/fenix/app/src/main/AndroidManifest.xml
index bc19c652029d..b64584dac276 100644
--- a/mobile/android/fenix/app/src/main/AndroidManifest.xml
+++ b/mobile/android/fenix/app/src/main/AndroidManifest.xml
@@ -494,12 +494,12 @@
             </intent-filter>
         </activity-alias>
 
-        <activity
+        <!-- <activity
             android:name=".startupCrash.StartupCrashActivity"
             android:exported="false"
             android:process=":StartupCrashActivityProcess"
             >
-        </activity>
+        </activity> -->
 
         <activity
             android:name=".HomeActivity"
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/FenixApplication.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/FenixApplication.kt
index 725fe78ce0cc..b0e96c64db70 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/FenixApplication.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/FenixApplication.kt
@@ -111,7 +111,7 @@ import org.mozilla.fenix.push.WebPushEngineIntegration
 import org.mozilla.fenix.session.VisibilityLifecycleCallback
 import org.mozilla.fenix.settings.doh.DefaultDohSettingsProvider
 import org.mozilla.fenix.settings.doh.DohSettingsProvider
-import org.mozilla.fenix.startupCrash.StartupCrashActivity
+// import org.mozilla.fenix.startupCrash.StartupCrashActivity
 import org.mozilla.fenix.utils.Settings
 import org.mozilla.fenix.utils.isLargeScreenSize
 import org.mozilla.fenix.wallpapers.Wallpaper
@@ -183,7 +183,7 @@ open class FenixApplication : LocaleAwareApplication(), Provider {
         //
         // Note: This doesn't setup any [UncaughtExceptionHandler].
         // Note: Gecko processes have their own crash handling mechanisms.
-        CrashReporter.registerDeferredInitializer(::setupCrashReporting)
+//        CrashReporter.registerDeferredInitializer(::setupCrashReporting)
 
         // While this [initializeFenixProcess] method is run for _all processes_ in the app, we only
         // do global initialization for the _main process_ here. This main process initialization
@@ -558,15 +558,15 @@ open class FenixApplication : LocaleAwareApplication(), Provider {
         }
     }
 
-    private fun setupCrashReporting(): CrashReporter {
-        return components
+    private fun setupCrashReporting() {
+/*        return components
             .analytics
             .crashReporter
-            .install(this, ::handleCaughtException)
+            .install(this, ::handleCaughtException) */
     }
 
     private fun handleCaughtException() {
-        if (
+/*        if (
             isMainProcess() &&
             Config.channel.isNightlyOrDebug &&
             !components.performance.visualCompletenessQueue.isReady()
@@ -575,7 +575,7 @@ open class FenixApplication : LocaleAwareApplication(), Provider {
 
             intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
             applicationContext.startActivity(intent)
-        }
+        } */
     }
 
     private fun initializeNimbus() {
@@ -602,7 +602,7 @@ open class FenixApplication : LocaleAwareApplication(), Provider {
     private fun setupMegazordInitial() {
         // Rust components must be initialized at the very beginning, before any other Rust call, ...
         AppServicesInitializer.init(
-            AppServicesConfig(components.analytics.crashReporter),
+            AppServicesConfig(),
         )
     }
 
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/components/BackgroundServices.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/components/BackgroundServices.kt
index 0bb38f8e5773..54dff3639970 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/components/BackgroundServices.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/components/BackgroundServices.kt
@@ -225,7 +225,7 @@ class BackgroundServices(
 
         // Enable push if it's configured.
         push.feature?.let { autoPushFeature ->
-            FxaPushSupportFeature(context, accountManager, autoPushFeature, crashReporter)
+            FxaPushSupportFeature(context, accountManager, autoPushFeature)
                 .initialize()
         }
 
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/crashtools/CrashTools.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/crashtools/CrashTools.kt
index 2c3ba7d17816..f26488e890ba 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/crashtools/CrashTools.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/crashtools/CrashTools.kt
@@ -31,7 +31,7 @@ import mozilla.components.compose.base.annotation.FlexibleWindowPreview
 import mozilla.components.compose.base.button.FilledButton
 import org.mozilla.fenix.R
 import org.mozilla.fenix.components.components
-import org.mozilla.fenix.startupCrash.StartupCrashActivity
+// import org.mozilla.fenix.startupCrash.StartupCrashActivity
 import org.mozilla.fenix.theme.FirefoxTheme
 import org.mozilla.fenix.theme.Theme
 import org.mozilla.fenix.theme.ThemeProvider
@@ -97,10 +97,10 @@ internal fun CrashTools(
                 text = stringResource(R.string.crash_debug_show_startup_crash_screen),
                 modifier = Modifier.fillMaxWidth(),
                 onClick = {
-                    val intent = Intent(appContext, StartupCrashActivity::class.java)
+//                    val intent = Intent(appContext, StartupCrashActivity::class.java)
 
-                    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
-                    appContext.startActivity(intent)
+//                    intent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK)
+//                    appContext.startActivity(intent)
                     Process.killProcess(Process.myPid())
                 },
             )
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/navigation/DebugDrawerRoute.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/navigation/DebugDrawerRoute.kt
index b55e0e05dcbb..e4d8405be9d1 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/navigation/DebugDrawerRoute.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/navigation/DebugDrawerRoute.kt
@@ -78,10 +78,10 @@ enum class DebugDrawerRoute(
         route = "addons_debug_tools",
         title = R.string.debug_drawer_addons_tools_title,
     ),
-    CrashDebugTools(
+/*    CrashDebugTools(
         route = "crash_debug_tools",
         title = R.string.crash_debug_tools_title,
-    ),
+    ), */
     ;
 
     companion object {
@@ -211,14 +211,14 @@ enum class DebugDrawerRoute(
                         }
                     }
 
-                    CrashDebugTools -> {
+/*                    CrashDebugTools -> {
                         onClick = {
                             debugDrawerStore.dispatch(DebugDrawerAction.NavigateTo.CrashDebugTools)
                         }
                         content = {
                             CrashTools()
                         }
-                    }
+                    } */
                 }
 
                 DebugDrawerDestination(
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/store/DebugDrawerNavigationMiddleware.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/store/DebugDrawerNavigationMiddleware.kt
index 07a2495fa830..d298ffd4555b 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/store/DebugDrawerNavigationMiddleware.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/debugsettings/store/DebugDrawerNavigationMiddleware.kt
@@ -54,7 +54,7 @@ class DebugDrawerNavigationMiddleware(
                 is DebugDrawerAction.NavigateTo.AddonsDebugTools ->
                     navController.navigate(route = DebugDrawerRoute.AddonsDebugTools.route)
                 is DebugDrawerAction.NavigateTo.CrashDebugTools ->
-                    navController.navigate(route = DebugDrawerRoute.CrashDebugTools.route)
+                    Unit // no-op
                 is DebugDrawerAction.OnBackPressed -> navController.popBackStack()
                 is DebugDrawerAction.DrawerOpened, DebugDrawerAction.DrawerClosed -> Unit // no-op
             }
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/BrowserToolbarSearchMiddleware.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/BrowserToolbarSearchMiddleware.kt
index 18ce0dc862b4..9105fda4e133 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/BrowserToolbarSearchMiddleware.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/BrowserToolbarSearchMiddleware.kt
@@ -233,14 +233,14 @@ class BrowserToolbarSearchMiddleware(
                 }
 
                 when (action.text) {
-                    "about:crashes" -> {
+/*                    "about:crashes" -> {
                         // The list of past crashes can be accessed via "settings > about", but desktop and
                         // fennec users may be used to navigating to "about:crashes". So we intercept this here
                         // and open the crash list activity instead.
                         navController.navigate(
                             NavGraphDirections.actionGlobalCrashListFragment(),
                         )
-                    }
+                    } */
                     "about:addons" -> {
                         navController.navigate(
                             NavGraphDirections.actionGlobalAddonsManagementFragment(),
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt
index e597abe8ca10..a84c839972be 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/search/SearchDialogController.kt
@@ -85,13 +85,13 @@ class SearchDialogController(
         }
 
         when (url) {
-            "about:crashes" -> {
+/*            "about:crashes" -> {
                 // The list of past crashes can be accessed via "settings > about", but desktop and
                 // fennec users may be used to navigating to "about:crashes". So we intercept this here
                 // and open the crash list activity instead.
                 val directions = SearchDialogFragmentDirections.actionCrashListFragment()
                 navController.navigate(directions)
-            }
+            } */
             "about:addons" -> {
                 val directions =
                     SearchDialogFragmentDirections.actionGlobalAddonsManagementFragment()
diff --git a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/utils/Settings.kt b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/utils/Settings.kt
index 81d95a9666a1..dae32881c9be 100644
--- a/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/utils/Settings.kt
+++ b/mobile/android/fenix/app/src/main/java/org/mozilla/fenix/utils/Settings.kt
@@ -563,7 +563,7 @@ class Settings(
 
     var crashReportChoice by stringPreference(
         appContext.getPreferenceKey(R.string.pref_key_crash_reporting_choice),
-        default = CrashReportOption.Ask.toString(),
+        default = CrashReportOption.Never.toString(),
     )
 
     val isRemoteDebuggingEnabled by booleanPreference(
@@ -970,7 +970,7 @@ class Settings(
      */
     var crashPullNeverShowAgain: Boolean by booleanPreference(
         appContext.getPreferenceKey(R.string.pref_key_crash_pull_never_show_again),
-        default = false,
+        default = true,
     )
 
     @VisibleForTesting
-- 
2.53.0

