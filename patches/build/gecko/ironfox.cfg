//
// Melding the Phoenix into a fox, with a strong coat of Ironâ€¦

// This is home to IronFox-specific preferences and configurations. Using AutoConfig instead of the standard pref files is preferable here,
// as it supports more advanced capabilities - ex. we can set user preferences, reset preferences, unlock preferences,
// set preferences if certain ones are/aren't set, etc.
// We can also set values depending on environment variables, and thanks to our patch, we can use this to configure environment variables directly as well.

// NOTE: Values surrounded in curly brackets ({}) are filled in by `build.sh`
/// IRONFOX_VERSION = {IRONFOX_VERSION}

/*** Environment ***/

// Disable Mozilla's ASan Crash Reporter
/// https://searchfox.org/firefox-main/rev/131497bb/toolkit/xre/nsEmbedFunctions.cpp#260
/// https://firefox-source-docs.mozilla.org/tools/sanitizer/asan_nightly.html
/// https://github.com/choller/firefox-asan-reporter
setEnv("MOZ_DISABLE_ASAN_REPORTER", 1);

// Disable Mozilla's Crash Reporter
/// https://firefox-source-docs.mozilla.org/toolkit/crashreporter/crashreporter/index.html#user-specified-environment-variables
setEnv("MOZ_ANDROID_CRASH_HANDLER", ''); // https://searchfox.org/firefox-main/rev/131497bb/mobile/android/geckoview/src/main/java/org/mozilla/gecko/mozglue/GeckoLoader.java#170
setEnv("MOZ_CRASHREPORTER", '');
setEnv("MOZ_CRASHREPORTER_DISABLE", 1);
setEnv("MOZ_CRASHREPORTER_NO_REPORT", 1);
setEnv("MOZ_CRASHREPORTER_URL", 'data;');

// Disable SSLKEYLOGGING
/// https://bugzilla.mozilla.org/show_bug.cgi?id=1183318
/// https://bugzilla.mozilla.org/show_bug.cgi?id=1915224
setEnv("SSLKEYLOGFILE", '');

/*** Preferences ***/

// Branding
lockPref("app.releaseNotesURL", "https://gitlab.com/ironfox-oss/IronFox/-/releases");
lockPref("app.releaseNotesURL.prompt", "https://gitlab.com/ironfox-oss/IronFox/-/releases");
lockPref("app.update.url.details", "https://gitlab.com/ironfox-oss/IronFox/-/releases");
lockPref("app.update.url.manual", "https://gitlab.com/ironfox-oss/IronFox/-/releases");
lockPref("app.vendorURL", "https://ironfoxoss.org/");
lockPref("browser.ironfox.isIronFox", true);

/// Set release channel
if (getenv("MOZ_ANDROID_PACKAGE_NAME") == "org.ironfoxoss.ironfox") {
    lockPref("browser.ironfox.channel", "release");
    lockPref("browser.ironfox.isNightly", false);
    lockPref("browser.ironfox.isRelease", true);
} else {
    lockPref("browser.ironfox.channel", "nightly");
    lockPref("browser.ironfox.isNightly", true);
    lockPref("browser.ironfox.isRelease", false);
};

//// If we're not on Nightly, reset Remote debugging to false on launch
if (getenv("MOZ_ANDROID_PACKAGE_NAME") != "org.ironfoxoss.ironfox.nightly") {
    pref("devtools.debugger.remote-enabled", false);
};

/// Set version
let phoenixVersion = getPref("browser.phoenix.version");
let ironfoxVersion = "{IRONFOX_VERSION}";
lockPref("browser.ironfox.version", `${ironfoxVersion}`);
if (getenv("MOZ_ANDROID_PACKAGE_NAME") == "org.ironfoxoss.ironfox") {
    browserName = "IronFox"
} else {
    browserName = "IronFox Nightly"
};
lockPref("app.support.vendor", `${browserName}: ${ironfoxVersion} | Phoenix - Extended: ${phoenixVersion}`);

// FPP
/// The following configures the behavior of FPP in IronFox
// Notably, this sets our desired global targets (without needing a patch/overlay file), and allows users to append their own overrides with the "browser.ironfox.fingerprintingProtection.userGlobalOverrides" preference
/// This also allows users to enable/disable timezone spoofing and WebGL with separate prefs

/// First, if users have previously set overrides with privacy.fingerprintingProtection.overrides, we need to migrate them to our new pref
//// (browser.ironfox.fingerprintingProtection.userGlobalOverrides)
defaultPref("browser.ironfox.fingerprintingProtection.migration.completed", false);
defaultPref("browser.ironfox.fingerprintingProtection.userGlobalOverrides", "");
defaultPref("privacy.fingerprintingProtection.overrides", "");
if (getPref("browser.ironfox.fingerprintingProtection.migration.completed" == false) && getPref("privacy.fingerprintingProtection.overrides" != "")) {
    let legacyUserFppTargets = getPref("privacy.fingerprintingProtection.overrides");
    pref("browser.ironfox.fingerprintingProtection.userGlobalOverrides", `${legacyUserFppTargets}`);
    clearPref("privacy.fingerprintingProtection.overrides");
    pref("browser.ironfox.fingerprintingProtection.migration.completed", true);
} else {
    lockPref("browser.ironfox.fingerprintingProtection.migration.completed", true);
};

/// Now, set our default FPP targets
let defaultFppTargets = "+AllTargets,-CanvasExtractionBeforeUserInputIsBlocked,-CanvasImageExtractionPrompt,-CSSPrefersColorScheme,-FrameRate";

/// Set user-specified targets
if (getPref("browser.ironfox.fingerprintingProtection.userGlobalOverrides") != "") {
    userFppTargets = "," + getPref("browser.ironfox.fingerprintingProtection.userGlobalOverrides");
} else {
    userFppTargets = ""
};

fppTargets = defaultFppTargets + userFppTargets;
lockPref("privacy.fingerprintingProtection.overrides", `${fppTargets}`);

/// Clear FPP granular overrides
//// We're including these internally with a custom Remote Settings dump instead of setting them here, which makes it far easier for users to add their own overrides if desired (by using this preference).
defaultPref("privacy.fingerprintingProtection.granularOverrides", ''); // [DEFAULT]

/// Provide an example template to make it easier for users to set custom global FPP overrides
defaultPref("browser.ironfox.fingerprintingProtection.userGlobalOverrides.0.example", "+ProtectionIWantToEnableGlobally,-ProtectionIWantToDisableGlobally");

/// Enable our granular FPP overrides by default
defaultPref("browser.ironfox.fingerprintingProtection.hardenOverrides.enabled", true); // Overrides from us that *harden* protections for certain sites
defaultPref("browser.ironfox.fingerprintingProtection.unbreakOverrides.enabled", true); // Overrides from us that *relax* protections for certain sites to reduce breakage
defaultPref("browser.ironfox.fingerprintingProtection.unbreakTimezoneOverrides.enabled", true); // Overrides from us that disable timezone spoofing for certain sites to reduce breakage
defaultPref("browser.ironfox.fingerprintingProtection.unbreakWebGLOverrides.enabled", true); // Overrides from us that re-enable WebGL for certain sites to reduce breakage

// Deregister the Glean add-on ping scheduler
clearPref("app.update.lastUpdateTime.glean-addons-daily");

// Disable mozAddonManager
/// mozAddonManager prevents extensions from working on `addons.mozilla.org`, and this API also exposes a list of the user's installed add-ons to `addons.mozilla.org`
/// Setting the following preferences usually breaks installation of extensions from `addons.mozilla.org` on Android, but we fix this with our `gecko-support-addon-installation-without-mozaddonmanager` patch
/// https://bugzilla.mozilla.org/show_bug.cgi?id=1952390#c4
/// https://bugzilla.mozilla.org/show_bug.cgi?id=1384330
defaultPref("extensions.webapi.enabled", false);
defaultPref("privacy.resistFingerprinting.block_mozAddonManager", true);

// Enable our Beacon API (navigator.sendBeacon) stub
/// Unlike standard Firefox, this doesn't actually enable the Beacon API; this just enables our stub - see the `stub-beacon` patch for more details
defaultPref("beacon.enabled", true); // [DEFAULT]

// Enable the Phoenix add-on blocklist by default
/// https://codeberg.org/celenity/Phoenix/src/branch/pages/build/policies/blocklist.json
defaultPref("browser.ironfox.extensions.blocklist.enabled", true);

// Ensure that certain site permissions are always/only controlled by their respective UI/permission prompts
lockPref("media.eme.require-app-approval", true); // [DEFAULT] EME
lockPref("media.geckoview.autoplay.request", true); // [DEFAULT] Media autoplay
lockPref("media.geckoview.autoplay.request.testing", 0); // [DEFAULT] Media autoplay
lockPref("network.localhost.prompt.testing", false); // [DEFAULT] LNA - localhost
lockPref("network.localnetwork.prompt.testing", false); // [DEFAULT] LNA - local network
lockPref("geo.prompt.testing", false); // [DEFAULT] Geolocation
lockPref("notification.prompt.testing", false); // [DEFAULT] Notifications

// Fix opening `tel` links in the Phone app
/// We only need this temporarily, fixed in Phoenix for next release
/// https://gitlab.com/ironfox-oss/IronFox/-/issues/231
defaultPref("network.protocol-handler.expose.tel", true);
defaultPref("network.protocol-handler.external.tel", true);

// No-op Nimbus
/// This needs to be set as a user pref for Firefox to properly use/recognize it
/// https://searchfox.org/firefox-main/rev/82e2435f/toolkit/components/nimbus/ExperimentAPI.sys.mjs#80
pref("nimbus.profileId", "");

// Onboarding
/// Once the onboarding is completed, this pref is set to true
/// On IronFox's onboarding, we want to allow the installation of uBlock Origin (if certain strict criteria is met - 
/// see gecko-ironfox-settings-support-xpinstall.patch) without needing to also enable the installation of add-ons
/// After onboarding though, we don't want this to be the case - so we use this pref to only allow the
/// installation during the onboarding
defaultPref("browser.ironfox.onboardingCompleted", false);

// PDF.js
/// These have to be set here for them to take effect
/// See '019 PDF.js' in Phoenix for details on these
defaultPref("pdfjs.altTextLearnMoreUrl", "https://support.mozilla.org/kb/pdf-alt-text");
defaultPref("pdfjs.commentLearnMoreUrl", "https://support.mozilla.org/kb/view-pdf-files-firefox-or-choose-another-viewer#w_add-a-comment-to-a-pdf");
defaultPref("pdfjs.disableFontFace", true);
defaultPref("pdfjs.disableRange", true);
defaultPref("pdfjs.disableStream", true);
defaultPref("pdfjs.enableAltText", true);
defaultPref("pdfjs.enableAltTextForEnglish", true);
defaultPref("pdfjs.enableAltTextModelDownload", false);
defaultPref("pdfjs.enableAutoLinking", false);
defaultPref("pdfjs.enableGuessAltText", false);
defaultPref("pdfjs.enableHWA", true);
defaultPref("pdfjs.enableNewAltTextWhenAddingImage", true);
defaultPref("pdfjs.enableOptimizedPartialRendering", true);
defaultPref("pdfjs.enablePermissions", false);
defaultPref("pdfjs.enableScripting", false);
defaultPref("pdfjs.enableSignatureEditor", true);
defaultPref("pdfjs.enableUpdatedAddImage", true);
defaultPref("pdfjs.enableXfa", false);
defaultPref("pdfjs.externalLinkTarget", 2);
defaultPref("pdfjs.sidebarViewOnLoad", 2);
defaultPref("pdfjs.textLayerMode", 1);

// Remote Settings
defaultPref("browser.ironfox.services.settings.allowedCollections", "blocklists/addons,blocklists/addons-bloomfilters,blocklists/gfx,blocklists/plugins,main/addons-data-leak-blocker-domains,main/anti-tracking-url-decoration,main/bounce-tracking-protection-exceptions,main/cookie-banner-rules-list,main/fingerprinting-protection-overrides,main/hijack-blocklists,main/ml-inference-options,main/ml-inference-request-options,main/ml-model-allow-deny-list,main/ml-onnx-runtime,main/partitioning-exempt-urls,main/password-recipes,main/public-suffix-list,main/query-stripping,main/remote-permissions,main/third-party-cookie-blocking-exempt-urls,main/tracking-protection-lists,main/translations-identification-models,main/translations-models,main/translations-models-v2,main/translations-wasm,main/translations-wasm-v2,main/url-classifier-exceptions,main/url-classifier-skip-urls,main/url-parser-default-unknown-schemes-interventions,main/webcompat-interventions,security-state/cert-revocations,security-state/ct-logs,security-state/intermediates,security-state/onecrl");
defaultPref("browser.ironfox.services.settings.allowedCollectionsFromDump", "main/ironfox-fingerprinting-protection-overrides-harden,main/ironfox-fingerprinting-protection-overrides-unbreak,main/ironfox-fingerprinting-protection-overrides-unbreak-timezone,main/ironfox-fingerprinting-protection-overrides-unbreak-webgl,blocklists/addons,blocklists/addons-bloomfilters,blocklists/gfx,blocklists/plugins,main/addons-data-leak-blocker-domains,main/anti-tracking-url-decoration,main/bounce-tracking-protection-exceptions,main/cookie-banner-rules-list,main/fingerprinting-protection-overrides,main/hijack-blocklists,main/moz-essential-domain-fallbacks,main/ml-inference-options,main/ml-inference-request-options,main/ml-model-allow-deny-list,main/ml-onnx-runtime,main/partitioning-exempt-urls,main/password-recipes,main/public-suffix-list,main/query-stripping,main/remote-permissions,main/third-party-cookie-blocking-exempt-urls,main/tracking-protection-lists,main/translations-identification-models,main/translations-models,main/translations-models-v2,main/translations-wasm,main/translations-wasm-v2,main/url-classifier-exceptions,main/url-classifier-skip-urls,main/url-parser-default-unknown-schemes-interventions,main/webcompat-interventions,security-state/cert-revocations,security-state/ct-logs,security-state/intermediates,security-state/onecrl");

// Safe Browsing
/// Mozilla used to define these values at `all.js`, but seem to have unfortunately stopped doing so
/// Instead, for Android, these are usually set by GeckoView's `ContentBlocking.java`
/// We don't want to set them with that mechanism though, as it prevents users from being able to override those
/// prefs - so we need to set them here
defaultPref("browser.safebrowsing.provider.google.advisoryURL", "https://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.provider.google.pver", "2.2");
defaultPref("browser.safebrowsing.provider.google4.advisoryURL", "https://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.provider.google4.lists", "goog-badbinurl-proto,goog-downloadwhite-proto,goog-phish-proto,googpub-phish-proto,goog-malware-proto,goog-unwanted-proto,goog-harmful-proto");
defaultPref("browser.safebrowsing.provider.google4.pver", "4");
defaultPref("browser.safebrowsing.provider.google5.advisoryURL", "https://developers.google.com/safe-browsing/v4/advisory");
defaultPref("browser.safebrowsing.provider.google5.lists", "goog-badbinurl-proto,goog-downloadwhite-proto,goog-phish-proto,googpub-phish-proto,goog-malware-proto,goog-unwanted-proto,goog-harmful-proto");

// uBlock Origin
defaultPref("browser.ironfox.uBO.autoCommentFilterTemplate", "{{url}}");
defaultPref("browser.ironfox.uBO.autoUpdateDelayAfterLaunch", "10");
defaultPref("browser.ironfox.uBO.disableWebAssembly", "true");
defaultPref("browser.ironfox.uBO.filterAuthorMode", "true");
defaultPref("browser.ironfox.uBO.uiPopupConfig", "+logger");
defaultPref("browser.ironfox.uBO.updateAssetBypassBrowserCache", "true");

/// Set default assets URL
if (getenv("MOZ_ANDROID_PACKAGE_NAME") == "org.ironfoxoss.ironfox") {
    defaultPref("browser.ironfox.uBO.assetsBootstrapLocation", "https://gitlab.com/ironfox-oss/assets/-/raw/main/uBlock/assets.main.json");
} else {
    defaultPref("browser.ironfox.uBO.assetsBootstrapLocation", "https://gitlab.com/ironfox-oss/assets/-/raw/main/uBlock/assets.dev.json");
};

// Ensure that prefs we expose as UI settings are always defined
defaultPref("accessibility.force_disabled", 1);
defaultPref("browser.cache.disk.enable", false);
defaultPref("browser.ironfox.fingerprintingProtection.timezoneSpoofing.enabled", false);
defaultPref("browser.privatebrowsing.autostart", false);
defaultPref("browser.safebrowsing.malware.enabled", true);
defaultPref("browser.safebrowsing.phishing.enabled", true);
defaultPref("browser.translations.enable", true);
defaultPref("browser.translations.simulateUnsupportedEngine", false);
defaultPref("extensions.formautofill.addresses.enabled", false);
defaultPref("extensions.formautofill.creditCards.enabled", false);
defaultPref("javascript.enabled", true);
defaultPref("javascript.options.baselinejit", false);
defaultPref("javascript.options.ion", false);
defaultPref("javascript.options.jit_trustedprincipals", false);
defaultPref("javascript.options.jithints", false);
defaultPref("javascript.options.native_regexp", false);
defaultPref("javascript.options.wasm", true);
defaultPref("javascript.options.wasm_optimizingjit", false);
defaultPref("layout.css.prefers-color-scheme.content-override", 1);
defaultPref("media.autoplay.blocking_policy", 1);
defaultPref("media.peerconnection.enabled", true);
defaultPref("network.dns.disableIPv6", false);
defaultPref("network.http.referer.XOriginPolicy", 0);
defaultPref("pdfjs.disabled", false);
defaultPref("print.enabled", true);
defaultPref("privacy.fingerprintingProtection.remoteOverrides.enabled", true);
defaultPref("privacy.spoof_english", 0); // We enable locale spoofing by default, but this has to be set to 0 initially to ensure its state is properly reflected
defaultPref("signon.rememberSignons", false);
defaultPref("svg.disabled", false);
defaultPref("webgl.disabled", true);
defaultPref("xpinstall.enabled", false);

/// Annotate locked prefs controlled by UI settings
lockPref("accessibility.force_disabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("accessibility.force_disabled.1.NOTE", "'Enable accessibility services'");
lockPref("browser.cache.disk.enable.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.cache.disk.enable.1.NOTE", "'Enable disk cache'");
lockPref("browser.ironfox.fingerprintingProtection.timezoneSpoofing.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.ironfox.fingerprintingProtection.timezoneSpoofing.enabled.1.NOTE", "'Spoof timezone to UTC-0'");
lockPref("browser.ironfox.fingerprintingProtection.unbreakOverrides.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.ironfox.fingerprintingProtection.unbreakOverrides.enabled.1.NOTE", "'Enable fingerprinting protection overrides from IronFox'");
lockPref("browser.ironfox.fingerprintingProtection.unbreakTimezoneOverrides.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.ironfox.fingerprintingProtection.unbreakTimezoneOverrides.enabled.1.NOTE", "'Enable timezone spoofing overrides from IronFox'");
lockPref("browser.ironfox.fingerprintingProtection.unbreakWebGLOverrides.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.ironfox.fingerprintingProtection.unbreakWebGLOverrides.enabled.1.NOTE", "'Enable WebGL overrides from IronFox'");
lockPref("browser.privatebrowsing.autostart.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.privatebrowsing.autostart.1.NOTE", "'Always use private browsing mode'");
lockPref("browser.safebrowsing.malware.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.safebrowsing.malware.enabled.1.NOTE", "'Enable Safe Browsing'");
lockPref("browser.safebrowsing.phishing.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.safebrowsing.phishing.enabled.1.NOTE", "'Enable Safe Browsing'");
lockPref("browser.translations.automaticallyPopup.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.translations.automaticallyPopup.1.NOTE", "'Offer to translate when possible'");
lockPref("browser.translations.enable.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.translations.enable.1.NOTE", "'Enable Firefox Translations'");
lockPref("browser.translations.simulateUnsupportedEngine.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.translations.simulateUnsupportedEngine.1.NOTE", "'Enable Firefox Translations'");
lockPref("browser.ui.zoom.force-user-scalable.0.NOTE", "Locked in favor of the UI setting:");
lockPref("browser.ui.zoom.force-user-scalable.1.NOTE", "'Zoom on all websites'");
lockPref("consoleservice.logcat.0.NOTE", "Locked in favor of the UI setting:");
lockPref("consoleservice.logcat.1.NOTE", "'Enable Gecko logs'");
lockPref("cookiebanners.service.mode.privateBrowsing.0.NOTE", "Locked in favor of the UI setting:");
lockPref("cookiebanners.service.mode.privateBrowsing.1.NOTE", "'Cookie Banner Blocker in private browsing'");
lockPref("devtools.console.stdout.chrome.0.NOTE", "Locked in favor of the UI setting:");
lockPref("devtools.console.stdout.chrome.1.NOTE", "'Enable Gecko logs'");
lockPref("dom.security.https_only_mode.0.NOTE", "Locked in favor of the UI setting:");
lockPref("dom.security.https_only_mode.1.NOTE", "'HTTPS-Only Mode'");
lockPref("dom.security.https_only_mode_pbm.0.NOTE", "Locked in favor of the UI setting:");
lockPref("dom.security.https_only_mode_pbm.1.NOTE", "'HTTPS-Only Mode'");
lockPref("extensions.formautofill.addresses.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("extensions.formautofill.addresses.enabled.1.NOTE", "'Save and fill addresses'");
lockPref("extensions.formautofill.creditCards.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("extensions.formautofill.creditCards.enabled.1.NOTE", "'Save and fill payment methods'");
lockPref("font.size.inflation.minTwips.0.NOTE", "Locked in favor of the UI setting:");
lockPref("font.size.inflation.minTwips.1.NOTE", "'Automatic font sizing'");
lockPref("geckoview.console.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("geckoview.console.enabled.1.NOTE", "'Enable Gecko logs'");
lockPref("geckoview.logging.0.NOTE", "Locked in favor of the UI setting:");
lockPref("geckoview.logging.1.NOTE", "'Enable Gecko logs'");
lockPref("javascript.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.enabled.1.NOTE", "'Enable JavaScript'");
lockPref("javascript.options.baselinejit.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.baselinejit.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT)'");
lockPref("javascript.options.jit_trustedprincipals.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.jit_trustedprincipals.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT) for extensions'");
lockPref("javascript.options.jithints.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.jithints.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT)'");
lockPref("javascript.options.ion.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.ion.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT)'");
lockPref("javascript.options.native_regexp.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.native_regexp.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT)'");
lockPref("javascript.options.wasm.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.wasm.1.NOTE", "'Enable WebAssembly (WASM)'");
lockPref("javascript.options.wasm_optimizingjit.0.NOTE", "Locked in favor of the UI setting:");
lockPref("javascript.options.wasm_optimizingjit.1.NOTE", "'Enable JavaScript Just-in-time Compilation (JIT)'");
lockPref("layout.css.prefers-color-scheme.content-override.0.NOTE", "Locked in favor of the UI setting:");
lockPref("layout.css.prefers-color-scheme.content-override.1.NOTE", "'Preferred website appearance'");
lockPref("media.autoplay.blocking_policy.0.NOTE", "Locked in favor of the UI setting:");
lockPref("media.autoplay.blocking_policy.1.NOTE", "'Media autoplay'");
lockPref("media.peerconnection.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("media.peerconnection.enabled.1.NOTE", "'Enable Widevine CDM'");
lockPref("network.dns.disableIPv6.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.dns.disableIPv6.1.NOTE", "'Enable IPv6 network connectivity'");
lockPref("network.http.referer.XOriginPolicy.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.http.referer.XOriginPolicy.1.NOTE", "'Cross-origin referer policy'");
lockPref("network.lna.blocking.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.lna.blocking.1.NOTE", "'Enable LNA blocking'");
lockPref("network.trr.default_provider_uri.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.trr.default_provider_uri.1.NOTE", "'DNS over HTTPS'");
lockPref("network.trr.excluded-domains.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.trr.excluded-domains.1.NOTE", "'DNS over HTTPS'");
lockPref("network.trr.mode.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.trr.mode.1.NOTE", "'DNS over HTTPS'");
lockPref("network.trr.uri.0.NOTE", "Locked in favor of the UI setting:");
lockPref("network.trr.uri.1.NOTE", "'DNS over HTTPS'");
lockPref("pdfjs.disabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("pdfjs.disabled.1.NOTE", "'Open PDF files externally'");
lockPref("print.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("print.enabled.1.NOTE", "'Enable printing capabilities'");
lockPref("privacy.fingerprintingProtection.overrides.0.NOTE", "Use browser.ironfox.fingerprintingProtection.userGlobalOverrides instead");
lockPref("privacy.fingerprintingProtection.remoteOverrides.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("privacy.fingerprintingProtection.remoteOverrides.enabled.1.NOTE", "'Enable fingerprinting protection overrides from Mozilla'");
lockPref("privacy.spoof_english.0.NOTE", "Locked in favor of the UI setting:");
lockPref("privacy.spoof_english.1.NOTE", "'Request English versions of webpages'");
lockPref("privacy.trackingprotection.allow_list.baseline.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("privacy.trackingprotection.allow_list.baseline.enabled.1.NOTE", "'Enhanced Tracking Protection'");
lockPref("privacy.trackingprotection.allow_list.convenience.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("privacy.trackingprotection.allow_list.convenience.enabled.1.NOTE", "'Enhanced Tracking Protection'");
lockPref("security.enterprise_roots.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("security.enterprise_roots.enabled.1.NOTE", "'Use third party CA certificates'");
lockPref("signon.autofillForms.0.NOTE", "Locked in favor of the UI setting:");
lockPref("signon.autofillForms.1.NOTE", "'Autofill in IronFox'");
lockPref("signon.rememberSignons.0.NOTE", "Locked in favor of the UI setting:");
lockPref("signon.rememberSignons.1.NOTE", "'Save passwords'");
lockPref("svg.disabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("svg.disabled.1.NOTE", "'Enable Scalable Vector Graphics (SVG)'");
lockPref("webgl.disabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("webgl.disabled.1.NOTE", "'Disable WebGL'");
lockPref("xpinstall.enabled.0.NOTE", "Locked in favor of the UI setting:");
lockPref("xpinstall.enabled.1.NOTE", "'Allow installation of add-ons'");

// Clear old Safe Browsing prefs that we no longer use
/// Them being around in the present results in console errors, so we reset them
clearPref("browser.safebrowsing.provider.ironfox.lastupdatetime");
clearPref("browser.safebrowsing.provider.ironfox.nextupdatetime");

lockPref("browser.ironfox.applied.cfg", true);
